{"version":3,"sources":["openseadragon-annotations.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_draw","_draw2","_move","_move2","_controls","_controls2","_overlay","_overlay2","initialize","options","OpenSeadragon","extend","this","state","controls","imagePath","addHandler","button","viewer","addControl","element","anchor","ControlAnchor","BOTTOM_LEFT","bind","onOpen","overlay","width","el","clientWidth","height","clientHeight","viewPort","svg","querySelector","setAttribute","add","setMouseNavEnabled","addEventListener","handleMouseDown","handleMouseUp","./controls","./draw","./move","./overlay",2,"EventSource","list","onClick","name","hasOwnProperty","imgDown","style","visibility","active","Button","tooltip","toUpperCase","substr","srcRest","srcGroup","srcHover","srcDown","raiseEvent","get",3,"_state","_state2","draw","create","_mouseTracker","x","offsetX","y","offsetY","_interval","path","document","createElementNS","appendChild","window","setInterval","getAttribute","stopPropagation","removeEventListener","clearInterval","./state",4,5,"_annotations","_annotations2","Viewer","prototype","initializeAnnotations","annotations","./annotations",6,"createElement","className","cursor","viewport","homeBounds","addOverlay","Rect",7],"mappings":"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","file":"openseadragon-annotations.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _draw = require('./draw');\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _move = require('./move');\n\nvar _move2 = _interopRequireDefault(_move);\n\nvar _controls = require('./controls');\n\nvar _controls2 = _interopRequireDefault(_controls);\n\nvar _overlay = require('./overlay');\n\nvar _overlay2 = _interopRequireDefault(_overlay);\n\nexports['default'] = {\n\n    initialize: function initialize(options) {\n        OpenSeadragon.extend(this, {\n            state: _move2['default'].initialize(),\n            controls: _controls2['default'].initialize({\n                imagePath: options.imagePath || ''\n            })\n        }, options);\n        this.controls.addHandler('add', (function (button) {\n            this.viewer.addControl(button.element, {\n                anchor: OpenSeadragon.ControlAnchor.BOTTOM_LEFT\n            });\n        }).bind(this));\n        return this;\n    },\n\n    onOpen: function onOpen() {\n        this.overlay = _overlay2['default'].initialize({\n            viewer: this.viewer\n        });\n\n        this.viewer.addHandler('animation', (function () {\n            var width = this.overlay.el.clientWidth;\n            var height = this.overlay.el.clientHeight;\n            var viewPort = '0 0 ' + width + ' ' + height;\n            var svg = this.overlay.el.querySelector('svg');\n            svg.setAttribute('viewPort', viewPort);\n        }).bind(this));\n\n        this.controls.add('move', true).addHandler('click', (function () {\n            this.viewer.setMouseNavEnabled(true);\n            this.state = _move2['default'].initialize();\n        }).bind(this));\n\n        this.controls.add('draw').addHandler('click', (function () {\n            this.viewer.setMouseNavEnabled(false);\n            this.state = _draw2['default'].initialize();\n        }).bind(this));\n\n        this.overlay.el.addEventListener('mousedown', (function (e) {\n            this.state.handleMouseDown(e, this.overlay);\n        }).bind(this), false);\n\n        this.overlay.el.addEventListener('mouseup', (function (e) {\n            this.state.handleMouseUp(e, this.overlay);\n        }).bind(this), false);\n\n        return this;\n    }\n\n};\nmodule.exports = exports['default'];\n\n},{\"./controls\":2,\"./draw\":3,\"./move\":4,\"./overlay\":6}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports['default'] = OpenSeadragon.extend(new OpenSeadragon.EventSource(), {\n\n    initialize: function initialize(options) {\n        OpenSeadragon.extend(this, options);\n        this.list = {};\n        this.addHandler('click', this.onClick.bind(this));\n        return this;\n    },\n\n    onClick: function onClick(name) {\n        for (var button in this.list) {\n            if (this.list.hasOwnProperty(button)) {\n                if (button === name) {\n                    this.list[button].imgDown.style.visibility = 'visible';\n                } else {\n                    this.list[button].imgDown.style.visibility = 'hidden';\n                }\n            }\n        }\n        return this;\n    },\n\n    add: function add(name, active) {\n        this.list[name] = new OpenSeadragon.Button({\n            tooltip: name[0].toUpperCase() + name.substr(1),\n            srcRest: this.imagePath + name + '_rest.png',\n            srcGroup: this.imagePath + name + '_grouphover.png',\n            srcHover: this.imagePath + name + '_hover.png',\n            srcDown: this.imagePath + name + '_pressed.png',\n            onClick: this.raiseEvent.bind(this, 'click', name)\n        });\n        if (active) {\n            this.list[name].imgDown.style.visibility = 'visible';\n        }\n        this.raiseEvent('add', this.list[name]);\n        return this.list[name];\n    },\n\n    get: function get(name) {\n        return this.list[name];\n    }\n\n});\nmodule.exports = exports['default'];\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _state = require('./state');\n\nvar _state2 = _interopRequireDefault(_state);\n\nvar draw = OpenSeadragon.extend(Object.create(_state2['default']), {\n\n    initialize: function initialize(options) {\n        OpenSeadragon.extend(this, options);\n        this._mouseTracker = (function (e) {\n            this.x = e.offsetX;\n            this.y = e.offsetY;\n        }).bind(this);\n        return this;\n    },\n\n    handleMouseDown: function handleMouseDown(e, overlay) {\n        if (!this._interval) {\n            this.x = e.offsetX;\n            this.y = e.offsetY;\n            var svg = overlay.el.querySelector('svg');\n            var path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n            path.setAttribute('fill', 'none');\n            path.setAttribute('stroke', 'red');\n            path.setAttribute('stroke-width', '0.5');\n            path.setAttribute('stroke-linejoin', 'round');\n            path.setAttribute('stroke-linecap', 'round');\n            path.setAttribute('d', 'M' + this.x / overlay.el.clientWidth * 100 + ' ' + this.y / overlay.el.clientHeight * 100);\n            svg.appendChild(path);\n\n            overlay.el.addEventListener('mousemove', this._mouseTracker, false);\n\n            this._interval = window.setInterval((function () {\n                path.setAttribute('d', path.getAttribute('d') + ' L' + this.x / overlay.el.clientWidth * 100 + ' ' + this.y / overlay.el.clientHeight * 100);\n            }).bind(this), 25);\n        }\n        e.stopPropagation();\n        return this;\n    },\n\n    handleMouseUp: function handleMouseUp(e, overlay) {\n        overlay.el.removeEventListener('mousemove', this._mouseTracker);\n        this._interval = clearInterval(this._interval);\n        return this;\n    }\n\n});\n\nexports['default'] = draw;\nmodule.exports = exports['default'];\n\n},{\"./state\":7}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _state = require('./state');\n\nvar _state2 = _interopRequireDefault(_state);\n\nexports['default'] = Object.create(_state2['default']);\nmodule.exports = exports['default'];\n\n},{\"./state\":7}],5:[function(require,module,exports){\n'use strict';\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _annotations = require('./annotations');\n\nvar _annotations2 = _interopRequireDefault(_annotations);\n\nif (!OpenSeadragon) {\n    throw new Error('OpenSeadragon Annotations requires OpenSeadragon');\n}\n\nOpenSeadragon.Viewer.prototype.initializeAnnotations = function (options) {\n    this.addHandler('open', _annotations2['default'].onOpen.bind(_annotations2['default']));\n    this.annotations = this.annotations || _annotations2['default'].initialize(OpenSeadragon.extend({ viewer: this }, options));\n    return this;\n};\n\n},{\"./annotations\":1}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports['default'] = {\n\n    initialize: function initialize(options) {\n        OpenSeadragon.extend(this, options);\n        this.el = document.createElement('div');\n        this.el.className = 'overlay';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('version', '1.1');\n        svg.setAttribute('width', '100%');\n        svg.setAttribute('height', '100%');\n        svg.setAttribute('preserveAspectRatio', 'none');\n        svg.setAttribute('viewBox', '0 0 100 100');\n        svg.style.cursor = 'default';\n        this.el.appendChild(svg);\n        var width = this.viewer.viewport.homeBounds.width;\n        var height = this.viewer.viewport.homeBounds.height;\n        this.viewer.addOverlay(this.el, new OpenSeadragon.Rect(0, 0, width, height));\n        return this;\n    }\n\n};\nmodule.exports = exports['default'];\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports[\"default\"] = {\n\n    initialize: function initialize(options) {\n        OpenSeadragon.extend(this, options);\n        return this;\n    },\n\n    handleMouseDown: function handleMouseDown() {\n        return this;\n    },\n\n    handleMouseUp: function handleMouseUp() {\n        return this;\n    }\n\n};\nmodule.exports = exports[\"default\"];\n\n},{}]},{},[5]);\n"],"sourceRoot":"/source/"}